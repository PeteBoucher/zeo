<!DOCTYPE html>
<html>
<head>
  <title>Servers - Zeo</title>
  <link href="/css/style.css" rel=stylesheet>
  <link href="/css/header.css" rel=stylesheet>
</head>
<body>
  <!-- header.html -->
  <script>
window.$ = s => document.querySelectorAll(s);

$('navbar > a').forEach(el => {
  if (el.classList.contains('servers')) {
    el.classList.add('selected');
  } else {
    el.classList.remove('selected');
  }
});
  </script>
  <div class=content>
    <div class=load-status>Loading...</div>
    <div class=load-placeholder>
      <div class=load-wrap>
        <h1>No servers :(</h1>
        <a href="/docs/tutorials" class=button>Create one</a>
      </div>
    </div>
    <div class=servers-body id=servers-body></div>
    <footer class=footer>
      <div class="footer-wrap full">
        <div class=footer-left><a href="/" class="link soft">Home</a> | <a href="https://github.com/modulesio/zeo" class="link soft">Github</a> | <a href="mailto:hello@zeovr.io" class="link soft">Contact</a></div>
        <div class=footer-right>&copy; 2017 <a href="mailto:a@zeovr.io">Zeo VR</a></div>
      </div>
    </footer>
  </div>
  <script src="/js/lib/creaturejs.js"></script>
  <script>
const loadStatus = $('.load-status')[0];
const loadPlaceholder = $('.load-placeholder')[0];
const serversBody = $('#servers-body')[0];

const _makeServerElement = server => {
  const {worldname, url, users} = server;

  const div = document.createElement('div');
  div.innerHTML = `<div class=server>
    <img class=server-image />
    <div class=server-wrap>
      <a href="${url}" class=name>${worldname}</a>
      <a href="${url}" class=url>
        <i>${url}</i>
      </a>
    </div>
    <div class=users>${users.map(user =>
      `<div class=user>${user}</div>`
    ).join('')}</div>
    <a href="${url}" class=server-arrow>
      <img src="/img/arrow-right.svg" />
    </a>
  </div>`;
  const serverElement = div.childNodes[0];

  setTimeout(() => {
    serverElement.querySelectorAll('.server-image')[0].src = creaturejs.makeStaticCreature('server:' + worldname);
  });

  return serverElement;
};
const _update = () => {
  loadStatus.style.display = 'flex';
  loadPlaceholder.style.display = 'none';

  while (serversBody.hasChildNodes()) {
    serversBody.removeChild(serversBody.lastChild);
  }
  serversBody.style.display = 'none';

  fetch('/servers/servers.json')
    .then(res => res.json()
      .then(({servers}) => {
        loadStatus.style.display = 'none';
        loadPlaceholder.style.display = servers.length === 0 ? 'flex' : 'none';

        for (let i = 0; i < servers.length; i++) {
          const server = servers[i];
          const serverElement = _makeServerElement(server);
          serversBody.appendChild(serverElement);
        }
        serversBody.style.display = servers.length > 0 ? 'flex' : 'none';
      })
    );
};
_update();
  </script>
</body>
</html/>
